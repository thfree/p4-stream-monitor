<!-- templates\partials\server.html -->
<div
    class="server"
    id="server-{{ server.id }}"
    data-server-id="{{ server.id }}"
    data-server-name="{{ server.name }}"
    data-streams-count="{{ server.streams|length }}"
>
    <div class="server-header">
        <div class="server-title-section">
            <div class="toggle-icon">‚ñº</div>
            <h2 class="server-title">{{ server.name }}</h2>
        </div>
        <div class="server-controls">
            <button
                class="btn-info btn-small"
                id="btn-list-{{ server.id }}"
                data-i18n="server.listStreams"
                data-i18n-title="server.listStreams"
                title="–ü–æ–∫–∞–∑–∞—Ç—å —Å–ø–∏—Å–æ–∫ —Å—Ç—Ä–∏–º–æ–≤"
            >
                üìã –°—Ç—Ä–∏–º—ã
            </button>
            <button
                class="btn-success btn-small"
                id="btn-sync-streams-{{ server.id }}"
                data-i18n="server.syncStreams"
                data-i18n-title="server.syncStreams"
                title="–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Å–ø–∏—Å–æ–∫ —Å—Ç—Ä–∏–º–æ–≤"
            >
                üîÑ –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å
            </button>
            <button
                class="btn-primary btn-small"
                id="btn-server-{{ server.id }}"
                data-i18n="server.updateWithSizes"
                data-i18n-title="server.updateWithSizes"
                title="–ü–æ–ª–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å —Ä–∞—Å—á—ë—Ç–æ–º —Ä–∞–∑–º–µ—Ä–æ–≤"
            >
                üìä –û–±–Ω–æ–≤–∏—Ç—å —Å —Ä–∞–∑–º–µ—Ä–∞–º–∏
            </button>
        </div>
    </div>

    <div class="server-info">
        {{ server.p4port }} ‚Ä¢ {{ server.streams|length }} 
        <span data-i18n="server.streams">—Å—Ç—Ä–∏–º–æ–≤</span>
        <span class="scroll-hint" style="display: none" data-i18n="server.scrollHint">
            (–ø—Ä–æ–∫—Ä—É—Ç–∫–∞ –≤–Ω—É—Ç—Ä–∏ –±–ª–æ–∫–∞)
        </span>
    </div>

    <div class="streams-container">
        <div class="streams-list">
            {% for stream in server.streams %}
            <div class="stream" id="stream-{{ stream.id }}">
                <div class="stream-controls">
                    <button
                        class="btn-primary btn-small"
                        id="btn-stream-{{ stream.id }}"
                        data-i18n-title="stream.refresh"
                        title="–û–±–Ω–æ–≤–∏—Ç—å —Ä–∞–∑–º–µ—Ä —Å—Ç—Ä–∏–º–∞"
                    >
                        üîÑ
                    </button>
                    <button
                        class="btn-stats btn-small"
                        id="btn-stats-{{ stream.id }}"
                        data-i18n-title="stream.stats"
                        title="–ü–æ–∫–∞–∑–∞—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –∏ –≥—Ä–∞—Ñ–∏–∫ —Ä–∞–∑–º–µ—Ä–∞"
                        onclick="StreamStats.showStats({{ stream.id }}, '{{ stream.name }}')"
                    >
                        üìà
                    </button>
                </div>

                <div class="stream-info">
                    <span class="stream-name">{{ stream.name }}</span> ‚Äî
                    <span class="stream-size" id="size-{{ stream.id }}">
                        {{ stream.size_bytes | filesizeformat }}
                    </span>
                    {% if stream.file_count is defined %}
                    <span class="file-count" id="file-count-{{ stream.id }}" 
                        data-exact-count="{{ stream.file_count }}"
                        data-original-count="{{ stream.file_count }}"
                        title="{{ '{:,}'.format(stream.file_count) }}">
                        ‚Ä¢ {{ '{:,}'.format(stream.file_count) }} <span data-i18n="stream.files">—Ñ–∞–π–ª–æ–≤</span>
                    </span>
                    {% endif %}
                </div>

                <div class="timestamp" id="timestamp-{{ stream.id }}">
                    <span data-i18n="stream.updated">–æ–±–Ω–æ–≤–ª–µ–Ω–æ</span>: 
                    {% if stream.last_updated %}{{ stream.last_updated.strftime('%Y-%m-%d %H:%M') }}{% else %}<span data-i18n="stream.never">–Ω–∏–∫–æ–≥–¥–∞</span>{% endif %}
                </div>

                <div class="status" id="status-{{ stream.id }}"></div>
            </div>
            {% endfor %}
        </div>
    </div>
</div>
